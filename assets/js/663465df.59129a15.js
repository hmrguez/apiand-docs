"use strict";(self.webpackChunkapiand_docs=self.webpackChunkapiand_docs||[]).push([[11],{5122:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"collaborate/add-templates","title":"How to add templates","description":"Each template needs 2 parts to work: the template itself and the config class.","source":"@site/docs/collaborate/add-templates.md","sourceDirName":"collaborate","slug":"/collaborate/add-templates","permalink":"/apiand-docs/docs/collaborate/add-templates","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Collaborate","permalink":"/apiand-docs/docs/category/collaborate"},"next":{"title":"How to add new CLI parameters","permalink":"/apiand-docs/docs/collaborate/add-cli-parameters"}}');var r=a(4848),o=a(8453);const i={sidebar_position:1},s="How to add templates",l={},d=[{value:"Adding an new architecture type",id:"adding-an-new-architecture-type",level:2},{value:"Adding a new template to an existing architecture type",id:"adding-a-new-template-to-an-existing-architecture-type",level:2},{value:"Example",id:"example",level:2},{value:"Need to add new parameters",id:"need-to-add-new-parameters",level:2},{value:"Generator support",id:"generator-support",level:2},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"how-to-add-templates",children:"How to add templates"})}),"\n",(0,r.jsx)(t.p,{children:"Each template needs 2 parts to work: the template itself and the config class."}),"\n",(0,r.jsx)(t.p,{children:"All templates are stored in the src/Apiand.TemplateEngine/Templates folder. The core component for a template is the architecture type. this determines th e initial folder to which to search for each template. Check the existing architecture types for better reference."}),"\n",(0,r.jsx)(t.p,{children:"When creating new templates you can go 2 ways: create a new architecture type from scratch or add your own templates or modules to an existing architecture type."}),"\n",(0,r.jsx)(t.h2,{id:"adding-an-new-architecture-type",children:"Adding an new architecture type"}),"\n",(0,r.jsx)(t.p,{children:"Now what's an architecture type? It is a way to group templates with similar nature together. It contains definitions for the templates, its modules, how to build the config, etc."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",children:"public abstract class ArchitectureType\n{\n    public abstract string Name { get; }\n    public abstract void LoadVariants(string basePath);\n    public abstract TemplateConfiguration BuildConfig(CommandOptions commandOptions);\n    public abstract ValidationResult Validate(TemplateConfiguration configuration);\n    public abstract Dictionary<string, string> Resolve(TemplateConfiguration configuration);\n    public abstract void ExecutePostCreationCommands(string outputPath, string projectName);\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"The Name property is the one the engine looks for when searching for a template. It's case sensitive."}),"\n",(0,r.jsx)(t.p,{children:"The way the templating engine works is:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"It looks for the architecture type with the same name as the one provided in the command line."}),"\n",(0,r.jsx)(t.li,{children:"It loads the variants for that architecture type, this means load all the templates available for that type."}),"\n",(0,r.jsx)(t.li,{children:"It builds the config for the template from the command."}),"\n",(0,r.jsx)(t.li,{children:"Validates that same config to check for errors"}),"\n",(0,r.jsx)(t.li,{children:"If no errors were found then it resolves the requested template. This means it will return a dictionary of all the templates it will need to create. This is because some templates might need to create more than one file (for example a DDD template which requires modules or variants for Presentation, Domain, Application and Infrastructure). The key is the name folder when it will be created and the second one is the path to the template folder in the engine"}),"\n",(0,r.jsxs)(t.li,{children:["Finally, it adds all the projects to a common solution file and executes any post-creation commands that the template might need to run, commonly you'll add all ",(0,r.jsx)(t.code,{children:"dotnet add reference"}),"s here."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"When adding a new architecture type you have the freedom of the way it loads and resolves all the templates, however, it is recommended to follow the same pattern as the existing ones."}),"\n",(0,r.jsx)(t.p,{children:"You'll need to also create a new command for the CLI to use this new architecture type. Follow the implementation of the existing DDD one (src/Apiand.Cli/Commands/New/NewDddCommand.cs) for reference. Then add the command to the register subcommands in the base NewCommand class"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",children:"private void RegisterSubcommands()\n{\n    AddCommand(new NewDddCommand());\n    ...\n    // Add your new command here\n}\n"})}),"\n",(0,r.jsx)(t.h2,{id:"adding-a-new-template-to-an-existing-architecture-type",children:"Adding a new template to an existing architecture type"}),"\n",(0,r.jsx)(t.p,{children:"This is the easiest part since generally only requires to add the template folder and perhaps update the logic of the architecture type to load the new template. Generally is advised to check the existing templates to see how they are structured."}),"\n",(0,r.jsx)(t.p,{children:"Also remember to update all from the architecture type class if needed, not just load and resolve, as the build config and validate are also important."}),"\n",(0,r.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(t.p,{children:"Let's check the existing example for the DDD architecture."}),"\n",(0,r.jsx)(t.p,{children:"A DDD architecture is composed in 4 layers: Presentation, Domain, Application and Infrastructure."}),"\n",(0,r.jsx)(t.p,{children:"An example of the folder structure for it is as follows:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"src/Apiand.TemplateEngine/Templates/DDD\n\u251c\u2500\u2500 Application\n\u2502   \u251c\u2500\u2500 Default\n\u251c\u2500\u2500 Domain\n\u2502   \u251c\u2500\u2500 Default\n\u251c\u2500\u2500 Infrastructure\n\u2502   \u251c\u2500\u2500 MongoDB\n\u2502   \u251c\u2500\u2500 EFCore\n\u251c\u2500\u2500 Presentation\n\u2502   \u251c\u2500\u2500 REST\n\u2502   \u251c\u2500\u2500 GraphQL\n"})}),"\n",(0,r.jsx)(t.p,{children:"It loads and resolves the templates for each layer searching for the folder matching each respective layer and the sub folder is considered an Option for that layer, for example, the DDD/Infrastructure/EFCore folder is considered an option for the Infrastructure layer."}),"\n",(0,r.jsx)(t.p,{children:"These options are also registered in the code in the TemplateEngine/Architectures/DDD/Options.cs"}),"\n",(0,r.jsx)(t.p,{children:"Here are both the options and the accepted options for each layer, which is used in the validation."}),"\n",(0,r.jsx)(t.h2,{id:"need-to-add-new-parameters",children:"Need to add new parameters"}),"\n",(0,r.jsxs)(t.p,{children:["If you need to add new parameters for resolving your templates you can follow ",(0,r.jsx)(t.a,{href:"/apiand-docs/docs/collaborate/add-cli-parameters",children:"this"})," guide"]}),"\n",(0,r.jsx)(t.h2,{id:"generator-support",children:"Generator support"}),"\n",(0,r.jsxs)(t.p,{children:["Most ",(0,r.jsx)(t.a,{href:"../components/generate",children:(0,r.jsx)(t.code,{children:"generate"})})," commands require specific behavior from the architecture type so you'll most likely need to check out ",(0,r.jsx)(t.a,{href:"add-generators",children:"this"})," guide on how to create your own generators for your new or modified template"]}),"\n",(0,r.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,r.jsx)(t.p,{children:"Adding a new template is a simple process, just follow the existing patterns and you should be good to go. If you have any questions feel free to ask in the issues section."})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>i,x:()=>s});var n=a(6540);const r={},o=n.createContext(r);function i(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);